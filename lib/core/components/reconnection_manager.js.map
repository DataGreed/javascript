{"version":3,"sources":["core/components/reconnection_manager.js"],"names":[],"mappings":";;;;;;;;AAAA;;;;AACA;;;;;;;AAcE,wBAAgF;AAAA,QAAlE,YAAkE,QAAlE,YAAkE;AAAA,QAApD,uBAAoD,QAApD,uBAAoD;;AAAA;;AAC9E,SAAK,aAAL,GAAqB,YAArB;AACA,SAAK,wBAAL,GAAgC,uBAAhC;AACA,SAAK,UAAL,GAAkB,IAAlB;AACD;;;;mCAEc;AACb,WAAK,UAAL,GAAkB,YAAY,KAAK,gBAAL,CAAsB,IAAtB,CAA2B,IAA3B,CAAZ,EAA8C,IAA9C,CAAlB;AACD;;;kCAEa;AACZ,oBAAc,KAAK,UAAnB;AACD;;;uCAEkB;AAAA;;AACjB,WAAK,aAAL,CAAmB,UAAC,MAAD,EAAgC;AACjD,YAAI,OAAO,KAAP,IAAgB,MAAK,UAAzB,EAAqC;AACnC,gBAAK,UAAL,GAAkB,KAAlB;AACA,gBAAK,wBAAL,CAA8B,MAAK,UAAnC;AACD,SAHD,MAGO,IAAI,CAAC,OAAO,KAAR,IAAiB,CAAC,MAAK,UAA3B,EAAuC;AAC5C,gBAAK,UAAL,GAAkB,KAAlB;AACA,gBAAK,wBAAL,CAA8B,MAAK,UAAnC;AACD;AACF,OARD;AASD","file":"core/components/reconnection_manager.js","sourcesContent":["import TimeEndpoint from '../endpoints/time';\nimport { StatusAnnouncement } from '../flow_interfaces';\n\ntype ReconnectionManagerArgs = {\n  timeEndpoint: TimeEndpoint,\n  onConnectionStateChange: Function\n}\n\nexport default class {\n\n  _onConnectionStateChange: Function;\n  _timeEndpoint: TimeEndpoint;\n  _timeTimer: number;\n  _connected: boolean;\n\n  constructor({ timeEndpoint, onConnectionStateChange }: ReconnectionManagerArgs) {\n    this._timeEndpoint = timeEndpoint;\n    this._onConnectionStateChange = onConnectionStateChange;\n    this._connected = true;\n  }\n\n  startPolling() {\n    this._timeTimer = setInterval(this._performTimeLoop.bind(this), 6000);\n  }\n\n  stopPolling() {\n    clearInterval(this._timeTimer);\n  }\n\n  _performTimeLoop() {\n    this._timeEndpoint((status: StatusAnnouncement) => {\n      if (status.error && this._connected) {\n        this._connected = false;\n        this._onConnectionStateChange(this._connected);\n      } else if (!status.error && !this._connected) {\n        this._connected = false;\n        this._onConnectionStateChange(this._connected);\n      }\n    });\n  }\n\n}\n"],"sourceRoot":"/source/"}